!function(){"use strict";angular.module("yandex-maps.plugin",["yandex-maps.plugin.templates","yaMap"]).config(function(){})}(),function(){"use strict";function e(e,a,l){console.log("contr");var i,n=this;i=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,n.fieldName=e.field.name,n.fieldValue="",n.readonly=e.field.readonly||!1,e.$parent.vm.error=[],n.parentFieldIndex=e.parentFieldIndex||!1,n.map=void 0,n.mapParam={height:e.field.mapHeight||"400",width:e.field.mapWidth||"400",center:e.field.mapCenter||[37.620393,55.765575],zoom:e.field.mapZoom||5},e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(n.multiple=!0,n.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(n.multiname=""+e.field.multiname||"value")):(n.multiple=!1,n.fieldValue=""),n.parentFieldIndex&&(n.multiple?(n.fieldValue=[],angular.forEach(l.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){n.multiname?n.fieldValue.push(e[n.multiname]):n.fieldValue.push(e)})):n.fieldValue=l.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||n.fieldValue),a.addFieldController(this),this.getFieldValue=function(){var a,l,i={};return n.multiple?n.fieldValue.length>0?(a=[],angular.forEach(n.fieldValue,function(e){a.push(e.join(","))})):a="":a=n.fieldValue?n.fieldValue.join(","):"",n.multiple&&n.multiname?(l=[],angular.forEach(a,function(e){var a={};a[n.multiname]=e,l.push(a)})):l=a,e.parentField?n.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][n.parentFieldIndex]={},i[e.parentField][n.parentFieldIndex][n.fieldName]=l):(i[e.parentField]={},i[e.parentField][n.fieldName]=l):i[n.fieldName]=l,i},this.getInitialValue=function(){var a={};return e.parentField?n.multiple?(a[e.parentField]={},a[e.parentField][n.fieldName]=[]):(a[e.parentField]={},a[e.parentField][n.fieldName]=""):n.multiple?a[n.fieldName]=[]:a[n.fieldName]="",a},n.addItem=function(){},n.removeItem=function(e){e="undefined"!=typeof e?e:-1,e>=0?angular.forEach(n.fieldValue,function(a,l){l==e&&n.fieldValue.splice(e,1)}):n.fieldValue=""},n.afterInit=function(e){n.map=e},n.mapDoubleClick=function(e){var a=e.get("coords");n.multiple?n.fieldValue.push(a):n.fieldValue||(n.fieldValue=a)},e.$on("editor:entity_loaded",function(a,l){return"new"===l.editorEntityType||null===l[e.field.name]?void(e.field.defaultValue?n.fieldValue=n.multiple?[e.field.defaultValue.split(",")]:e.field.defaultValue.split(","):n.fieldValue=n.multiple?[]:""):(e.parentField?n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(l[e.parentField][e.field.name],function(e){n.fieldValue.push(e[n.multiname].split(","))})):(n.fieldValue=[],angular.forEach(l[e.parentField][e.field.name],function(e){n.fieldValue.push(e.split(","))})):n.fieldValue=l[e.parentField][e.field.name]?l[e.parentField][e.field.name].split(","):"":n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(l[e.field.name],function(e){n.fieldValue.push(e[n.multiname].split(","))})):(n.fieldValue=[],angular.forEach(l[e.field.name],function(e){n.fieldValue.push(e.split(","))})):n.fieldValue=l[e.field.name]?l[e.field.name].split(","):"",void e.$evalAsync(function(){n.multiple?n.fieldValue.length>0&&(n.mapParam.center=n.fieldValue[0]):n.fieldValue&&(n.mapParam.center=n.fieldValue)}))}),e.$on("editor:api_error_field_"+i,function(a,l){angular.isArray(l)?angular.forEach(l,function(a){e.$parent.vm.error.indexOf(a)<0&&e.$parent.vm.error.push(a)}):e.$parent.vm.error.indexOf(l)<0&&e.$parent.vm.error.push(l)}),e.$on("$destroy",function(){a.deleteFieldController(n),n.parentFieldIndex&&l.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,n.fieldValue)}),e.$watch(function(){return n.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("yandex-maps.plugin").controller("EditorFieldYandexMapsController",e),e.$inject=["$scope","EditEntityStorage","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function a(e,a,l,i){console.log("dir"),a.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldYandexMaps/editorFieldYandexMaps.html"),controller:"EditorFieldYandexMapsController",controllerAs:"vm",link:a}}angular.module("yandex-maps.plugin").directive("editorFieldYandexMaps",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("yandex-maps.plugin.templates")}catch(a){e=angular.module("yandex-maps.plugin.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldYandexMaps/editorFieldYandexMaps.html",'\n<div>\n    <div class="field-map-wrapper col-lg-6 col-md-6 col-sm-7 col-xs-8">\n        <ya-map data-ya-center="{{vm.mapParam.center}}" data-ya-zoom="{{vm.mapParam.zoom}}" data-ya-after-init="vm.afterInit($target)" data-ya-event-dblclick="vm.mapDoubleClick($event)" data-ya-controls="zoomControl searchControl fullscreenControl" data-ya-behaviors="scrollZoom multiTouch drag" style="width: {{vm.mapParam.width}}px; height: {{vm.mapParam.height}}px; display: block;">\n            <ya-geo-object data-ng-if="!vm.multiple &amp;&amp; vm.fieldValue" data-ya-source="{geometry:{type : \'Point\', coordinates : vm.fieldValue}}"></ya-geo-object>\n            <ya-geo-object data-ng-if="vm.multiple" data-ng-repeat="mark in vm.fieldValue track by $index" data-ya-source="{geometry:{type : \'Point\', coordinates : mark}, properties : { iconContent : $index + 1 }}"></ya-geo-object>\n        </ya-map>\n        <div class="field-map-values">\n            <div data-ng-if="vm.multiple" data-ng-repeat="item in vm.fieldValue track by $index" class="item-map-wrapper">\n                <div data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly &amp;&amp; vm.fieldValue.length" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE_MARK\' | translate}} {{$index + 1}}</div>\n            </div>\n            <div data-ng-if="!vm.multiple" class="item-map-wrapper">\n                <div data-ng-click="vm.removeItem()" data-ng-if="!vm.readonly &amp;&amp; vm.fieldValue" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE_MARK\' | translate}}</div>\n            </div>\n        </div>\n    </div>\n</div>')}])}();